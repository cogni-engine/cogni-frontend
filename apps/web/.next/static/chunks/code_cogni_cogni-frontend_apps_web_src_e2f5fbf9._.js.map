{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/supabase/browserClient.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr';\n\nexport function createClient() {\n  return createBrowserClient(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n  );\n}\n"],"names":[],"mappings":";;;;AAII;AAJJ;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,uVAAmB;AAI5B","debugId":null}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/api/threadsApi.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/browserClient';\nimport type { Thread } from '@/types/thread';\n\nconst supabase = createClient();\n\n/**\n * Get all threads for a specific workspace\n */\nexport async function getThreads(workspaceId: number): Promise<Thread[]> {\n  const { data, error } = await supabase\n    .from('threads')\n    .select('*')\n    .eq('workspace_id', workspaceId)\n    .order('updated_at', { ascending: false });\n\n  if (error) throw error;\n  return data || [];\n}\n\n/**\n * Get a single thread by ID\n */\nexport async function getThread(id: number): Promise<Thread | null> {\n  const { data, error } = await supabase\n    .from('threads')\n    .select('*')\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      // Not found\n      return null;\n    }\n    throw error;\n  }\n\n  return data;\n}\n\n/**\n * Create a new thread\n */\nexport async function createThread(\n  workspaceId: number,\n  title: string\n): Promise<Thread> {\n  const { data, error } = await supabase\n    .from('threads')\n    .insert({\n      workspace_id: workspaceId,\n      title,\n    })\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\n/**\n * Update an existing thread\n */\nexport async function updateThread(id: number, title: string): Promise<Thread> {\n  const { data, error } = await supabase\n    .from('threads')\n    .update({\n      title,\n      updated_at: new Date().toISOString(),\n    })\n    .eq('id', id)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\n/**\n * Delete a thread\n */\nexport async function deleteThread(id: number): Promise<void> {\n  const { error } = await supabase.from('threads').delete().eq('id', id);\n\n  if (error) throw error;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAGA,MAAM,WAAW,IAAA,+MAAY;AAKtB,eAAe,WAAW,WAAmB;IAClD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,WACL,MAAM,CAAC,KACP,EAAE,CAAC,gBAAgB,aACnB,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM;IAE1C,IAAI,OAAO,MAAM;IACjB,OAAO,QAAQ,EAAE;AACnB;AAKO,eAAe,UAAU,EAAU;IACxC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,WACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,IACT,MAAM;IAET,IAAI,OAAO;QACT,IAAI,MAAM,IAAI,KAAK,YAAY;YAC7B,YAAY;YACZ,OAAO;QACT;QACA,MAAM;IACR;IAEA,OAAO;AACT;AAKO,eAAe,aACpB,WAAmB,EACnB,KAAa;IAEb,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,WACL,MAAM,CAAC;QACN,cAAc;QACd;IACF,GACC,MAAM,GACN,MAAM;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAKO,eAAe,aAAa,EAAU,EAAE,KAAa;IAC1D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,WACL,MAAM,CAAC;QACN;QACA,YAAY,IAAI,OAAO,WAAW;IACpC,GACC,EAAE,CAAC,MAAM,IACT,MAAM,GACN,MAAM;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAKO,eAAe,aAAa,EAAU;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,WAAW,MAAM,GAAG,EAAE,CAAC,MAAM;IAEnE,IAAI,OAAO,MAAM;AACnB","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/cookies.ts"],"sourcesContent":["// Utility functions for managing cookies on the client side\n\nconst isBrowser = typeof document !== 'undefined';\n\nexport function setCookie(name: string, value: string, days: number = 365) {\n  if (!isBrowser) return;\n\n  const expires = new Date();\n  expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);\n  document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Lax`;\n}\n\nexport function getCookie(name: string): string | null {\n  if (!isBrowser) return null;\n\n  const nameEQ = name + '=';\n  const ca = document.cookie.split(';');\n  for (let i = 0; i < ca.length; i++) {\n    let c = ca[i];\n    while (c.charAt(0) === ' ') c = c.substring(1, c.length);\n    if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);\n  }\n  return null;\n}\n\nexport function deleteCookie(name: string) {\n  if (!isBrowser) return;\n\n  document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`;\n}\n\n// Specific cookie keys\nexport const COOKIE_KEYS = {\n  PERSONAL_WORKSPACE_ID: 'personal_workspace_id',\n  PENDING_INVITE_TOKEN: 'pending_invite_token',\n  CURRENT_USER_ID: 'current_user_id',\n} as const;\n\n// Helper functions for specific cookies\nexport function getPersonalWorkspaceId(): number | null {\n  const id = getCookie(COOKIE_KEYS.PERSONAL_WORKSPACE_ID);\n  return id ? parseInt(id, 10) : null;\n}\n\nexport function getPendingInviteToken(): string | null {\n  return getCookie(COOKIE_KEYS.PENDING_INVITE_TOKEN);\n}\n\nexport function clearPendingInviteToken() {\n  deleteCookie(COOKIE_KEYS.PENDING_INVITE_TOKEN);\n}\n\nexport function getCurrentUserId(): string | null {\n  return getCookie(COOKIE_KEYS.CURRENT_USER_ID);\n}\n\nexport function setCurrentUserId(userId: string) {\n  setCookie(COOKIE_KEYS.CURRENT_USER_ID, userId);\n}\n\nexport function clearCurrentUserId() {\n  deleteCookie(COOKIE_KEYS.CURRENT_USER_ID);\n}\n\n/**\n * Clear all user-related cookies (should be called on logout)\n */\nexport function clearAllUserCookies() {\n  deleteCookie(COOKIE_KEYS.PERSONAL_WORKSPACE_ID);\n  deleteCookie(COOKIE_KEYS.PENDING_INVITE_TOKEN);\n  deleteCookie(COOKIE_KEYS.CURRENT_USER_ID);\n}\n"],"names":[],"mappings":"AAAA,4DAA4D;;;;;;;;;;;;;;;;;;;;;;;;;AAE5D,MAAM,YAAY,OAAO,aAAa;AAE/B,SAAS,UAAU,IAAY,EAAE,KAAa;QAAE,OAAA,iEAAe;IACpE,IAAI,CAAC,WAAW;IAEhB,MAAM,UAAU,IAAI;IACpB,QAAQ,OAAO,CAAC,QAAQ,OAAO,KAAK,OAAO,KAAK,KAAK,KAAK;IAC1D,SAAS,MAAM,GAAG,AAAC,GAAU,OAAR,MAAK,KAAoB,OAAjB,OAAM,aAAiC,OAAtB,QAAQ,WAAW,IAAG;AACtE;AAEO,SAAS,UAAU,IAAY;IACpC,IAAI,CAAC,WAAW,OAAO;IAEvB,MAAM,SAAS,OAAO;IACtB,MAAM,KAAK,SAAS,MAAM,CAAC,KAAK,CAAC;IACjC,IAAK,IAAI,IAAI,GAAG,IAAI,GAAG,MAAM,EAAE,IAAK;QAClC,IAAI,IAAI,EAAE,CAAC,EAAE;QACb,MAAO,EAAE,MAAM,CAAC,OAAO,IAAK,IAAI,EAAE,SAAS,CAAC,GAAG,EAAE,MAAM;QACvD,IAAI,EAAE,OAAO,CAAC,YAAY,GAAG,OAAO,EAAE,SAAS,CAAC,OAAO,MAAM,EAAE,EAAE,MAAM;IACzE;IACA,OAAO;AACT;AAEO,SAAS,aAAa,IAAY;IACvC,IAAI,CAAC,WAAW;IAEhB,SAAS,MAAM,GAAG,AAAC,GAAO,OAAL,MAAK;AAC5B;AAGO,MAAM,cAAc;IACzB,uBAAuB;IACvB,sBAAsB;IACtB,iBAAiB;AACnB;AAGO,SAAS;IACd,MAAM,KAAK,UAAU,YAAY,qBAAqB;IACtD,OAAO,KAAK,SAAS,IAAI,MAAM;AACjC;AAEO,SAAS;IACd,OAAO,UAAU,YAAY,oBAAoB;AACnD;AAEO,SAAS;IACd,aAAa,YAAY,oBAAoB;AAC/C;AAEO,SAAS;IACd,OAAO,UAAU,YAAY,eAAe;AAC9C;AAEO,SAAS,iBAAiB,MAAc;IAC7C,UAAU,YAAY,eAAe,EAAE;AACzC;AAEO,SAAS;IACd,aAAa,YAAY,eAAe;AAC1C;AAKO,SAAS;IACd,aAAa,YAAY,qBAAqB;IAC9C,aAAa,YAAY,oBAAoB;IAC7C,aAAa,YAAY,eAAe;AAC1C","debugId":null}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/hooks/useThreads.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect, useCallback } from 'react';\nimport useSWR from 'swr';\nimport {\n  getThreads,\n  getThread,\n  createThread,\n  updateThread,\n  deleteThread,\n} from '@/lib/api/threadsApi';\nimport type { Thread } from '@/types/thread';\nimport { getPersonalWorkspaceId } from '@/lib/cookies';\n\nexport function useThreads() {\n  const [threads, setThreads] = useState<Thread[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchThreads = useCallback(async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const workspaceId = getPersonalWorkspaceId();\n      if (!workspaceId) {\n        throw new Error('No personal workspace found');\n      }\n\n      const data = await getThreads(workspaceId);\n      setThreads(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch threads');\n      console.error('Error fetching threads:', err);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const createNewThread = useCallback(async (title: string) => {\n    try {\n      setError(null);\n\n      const workspaceId = getPersonalWorkspaceId();\n      if (!workspaceId) {\n        throw new Error('No personal workspace found');\n      }\n\n      const newThread = await createThread(workspaceId, title);\n      setThreads(prev => [newThread, ...prev]);\n      return newThread;\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to create thread');\n      console.error('Error creating thread:', err);\n      throw err;\n    }\n  }, []);\n\n  const updateExistingThread = useCallback(\n    async (id: number, title: string) => {\n      try {\n        setError(null);\n\n        const updatedThread = await updateThread(id, title);\n        setThreads(prev =>\n          prev.map(thread => (thread.id === id ? updatedThread : thread))\n        );\n        return updatedThread;\n      } catch (err) {\n        setError(\n          err instanceof Error ? err.message : 'Failed to update thread'\n        );\n        console.error('Error updating thread:', err);\n        throw err;\n      }\n    },\n    []\n  );\n\n  const deleteExistingThread = useCallback(async (id: number) => {\n    try {\n      setError(null);\n\n      await deleteThread(id);\n      setThreads(prev => prev.filter(thread => thread.id !== id));\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to delete thread');\n      console.error('Error deleting thread:', err);\n      throw err;\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchThreads();\n  }, [fetchThreads]);\n\n  return {\n    threads,\n    loading,\n    error,\n    refetch: fetchThreads,\n    createThread: createNewThread,\n    updateThread: updateExistingThread,\n    deleteThread: deleteExistingThread,\n  };\n}\n\n/**\n * Hook for fetching an existing thread by ID using SWR\n */\nexport function useThread(id: number) {\n  const { data, error, isLoading } = useSWR<Thread | null>(\n    `/threads/${id}`,\n    () => getThread(id),\n    {\n      revalidateOnFocus: false,\n      revalidateOnReconnect: true,\n    }\n  );\n\n  return {\n    thread: data,\n    loading: isLoading,\n    error,\n  };\n}\n\n/**\n * Hook for creating a new thread\n */\nexport function useNewThread() {\n  const [thread, setThread] = useState<Thread | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const workspaceId = getPersonalWorkspaceId();\n    if (!workspaceId) {\n      setLoading(false);\n      return;\n    }\n\n    setThread({\n      id: 0,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n      title: '',\n      workspace_id: workspaceId,\n    });\n    setLoading(false);\n  }, []);\n\n  return { thread, loading, error: null };\n}\n\n/**\n * Hook for thread mutations (create, update, delete)\n */\nexport function useThreadMutations() {\n  const create = useCallback(async (title: string) => {\n    const workspaceId = getPersonalWorkspaceId();\n    if (!workspaceId) throw new Error('No personal workspace found');\n\n    const newThread = await createThread(workspaceId, title);\n    return newThread;\n  }, []);\n\n  const update = useCallback(async (id: number, title: string) => {\n    const updatedThread = await updateThread(id, title);\n    return updatedThread;\n  }, []);\n\n  const remove = useCallback(async (id: number) => {\n    await deleteThread(id);\n  }, []);\n\n  return { create, update, remove };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 368, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/contexts/ThreadContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, ReactNode } from 'react';\n\ninterface ThreadContextType {\n  selectedThreadId: number | null;\n  setSelectedThreadId: (id: number | null) => void;\n}\n\nconst ThreadContext = createContext<ThreadContextType | undefined>(undefined);\n\nexport function ThreadProvider({ children }: { children: ReactNode }) {\n  const [selectedThreadId, setSelectedThreadId] = useState<number | null>(null);\n\n  return (\n    <ThreadContext.Provider value={{ selectedThreadId, setSelectedThreadId }}>\n      {children}\n    </ThreadContext.Provider>\n  );\n}\n\nexport function useThreadContext() {\n  const context = useContext(ThreadContext);\n  if (context === undefined) {\n    throw new Error('useThreadContext must be used within a ThreadProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AASA,MAAM,8BAAgB,IAAA,kaAAa,EAAgC;AAE5D,SAAS,eAAe,KAAqC;QAArC,EAAE,QAAQ,EAA2B,GAArC;;IAC7B,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,6ZAAQ,EAAgB;IAExE,qBACE,ibAAC,cAAc,QAAQ;QAAC,OAAO;YAAE;YAAkB;QAAoB;kBACpE;;;;;;AAGP;GARgB;KAAA;AAUT,SAAS;;IACd,MAAM,UAAU,IAAA,+ZAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB","debugId":null}},
    {"offset": {"line": 417, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/api/notificationsApi.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/browserClient';\nimport type { Notification, NotificationStatus } from '@/types/notification';\n\nconst supabase = createClient();\n\n/**\n * Get all notifications for a specific user\n */\nexport async function getNotifications(\n  userId: string\n): Promise<Notification[]> {\n  const { data, error } = await supabase\n    .from('notifications')\n    .select('*')\n    .eq('user_id', userId)\n    .order('due_date', { ascending: true });\n\n  if (error) throw error;\n  return data || [];\n}\n\n/**\n * Get scheduled notifications that are past their due date\n */\nexport async function getScheduledNotifications(\n  userId: string\n): Promise<Notification[]> {\n  const now = new Date().toISOString();\n\n  const { data, error } = await supabase\n    .from('notifications')\n    .select('*')\n    .eq('user_id', userId)\n    .eq('status', 'scheduled')\n    .lt('due_date', now)\n    .order('due_date', { ascending: true });\n\n  if (error) throw error;\n  return data || [];\n}\n\n/**\n * Get past due notifications (scheduled or sent) for notification center\n * This includes both new notifications and ones that have already been viewed\n */\nexport async function getPastDueNotifications(\n  userId: string\n): Promise<Notification[]> {\n  const now = new Date().toISOString();\n\n  const { data, error } = await supabase\n    .from('notifications')\n    .select('*')\n    .eq('user_id', userId)\n    .in('status', ['scheduled', 'sent'])\n    .lt('due_date', now)\n    .order('due_date', { ascending: true });\n\n  if (error) throw error;\n  return data || [];\n}\n\n/**\n * Get a single notification by ID\n */\nexport async function getNotification(\n  id: number\n): Promise<Notification | null> {\n  const { data, error } = await supabase\n    .from('notifications')\n    .select('*')\n    .eq('id', id)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      // Not found\n      return null;\n    }\n    throw error;\n  }\n\n  return data;\n}\n\n/**\n * Mark a notification as sent\n */\nexport async function markNotificationAsSent(\n  id: number\n): Promise<Notification> {\n  const { data, error } = await supabase\n    .from('notifications')\n    .update({\n      status: 'sent' as NotificationStatus,\n      updated_at: new Date().toISOString(),\n    })\n    .eq('id', id)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\n/**\n * Mark multiple notifications as sent\n */\nexport async function markMultipleNotificationsAsSent(\n  ids: number[]\n): Promise<Notification[]> {\n  if (ids.length === 0) return [];\n\n  const { data, error } = await supabase\n    .from('notifications')\n    .update({\n      status: 'sent' as NotificationStatus,\n      updated_at: new Date().toISOString(),\n    })\n    .in('id', ids)\n    .select();\n\n  if (error) throw error;\n  return data || [];\n}\n\n/**\n * Update notification status\n */\nexport async function updateNotificationStatus(\n  id: number,\n  status: NotificationStatus\n): Promise<Notification> {\n  const { data, error } = await supabase\n    .from('notifications')\n    .update({\n      status,\n      updated_at: new Date().toISOString(),\n    })\n    .eq('id', id)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(id: number): Promise<void> {\n  const { error } = await supabase.from('notifications').delete().eq('id', id);\n\n  if (error) throw error;\n}\n\n/**\n * Count unread notifications (scheduled and past due date)\n */\nexport async function getUnreadNotificationCount(\n  userId: string\n): Promise<number> {\n  const now = new Date().toISOString();\n\n  const { count, error } = await supabase\n    .from('notifications')\n    .select('*', { count: 'exact', head: true })\n    .eq('user_id', userId)\n    .eq('status', 'scheduled')\n    .lt('due_date', now);\n\n  if (error) throw error;\n  return count || 0;\n}\n\n/**\n * Trigger notification - generates AI conversation response and marks as resolved\n */\nexport async function triggerNotification(\n  notificationId: number,\n  threadId: number\n): Promise<void> {\n  const response = await fetch(\n    `${process.env.NEXT_PUBLIC_API_BASE_URL || 'http://0.0.0.0:8000'}/api/cogno/notification/trigger`,\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        notification_id: notificationId,\n        thread_id: threadId,\n      }),\n    }\n  );\n\n  if (!response.ok) {\n    throw new Error('Failed to trigger notification');\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 540, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/hooks/useNotifications.ts"],"sourcesContent":["'use client';\n\nimport { useState, useCallback } from 'react';\nimport {\n  getNotifications,\n  getScheduledNotifications,\n  getPastDueNotifications,\n  markNotificationAsSent,\n  markMultipleNotificationsAsSent,\n  updateNotificationStatus,\n  deleteNotification,\n  getUnreadNotificationCount,\n} from '@/lib/api/notificationsApi';\nimport type { Notification, NotificationStatus } from '@/types/notification';\n\n/**\n * Check if a notification is past its due date\n */\nfunction isPastDue(dueDate: string): boolean {\n  return new Date(dueDate) < new Date();\n}\n\n/**\n * Format date for display\n */\nfunction formatDate(dateString: string): string {\n  const date = new Date(dateString);\n  return date.toLocaleDateString('ja-JP', {\n    year: 'numeric',\n    month: '2-digit',\n    day: '2-digit',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\nexport function useNotifications(userId?: string) {\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  /**\n   * Fetch all notifications for the user\n   */\n  const fetchNotifications = useCallback(async () => {\n    if (!userId) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await getNotifications(userId);\n      setNotifications(data);\n    } catch (err) {\n      console.error('Failed to fetch notifications:', err);\n      setError(\n        err instanceof Error ? err.message : 'Failed to fetch notifications'\n      );\n    } finally {\n      setLoading(false);\n    }\n  }, [userId]);\n\n  /**\n   * Fetch scheduled notifications that are past their due date\n   */\n  const fetchScheduledNotifications = useCallback(async () => {\n    if (!userId) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await getScheduledNotifications(userId);\n      setNotifications(data);\n    } catch (err) {\n      console.error('Failed to fetch scheduled notifications:', err);\n      setError(\n        err instanceof Error\n          ? err.message\n          : 'Failed to fetch scheduled notifications'\n      );\n    } finally {\n      setLoading(false);\n    }\n  }, [userId]);\n\n  /**\n   * Fetch past due notifications (scheduled or sent) for notification center\n   */\n  const fetchPastDueNotifications = useCallback(async () => {\n    if (!userId) {\n      setLoading(false);\n      return;\n    }\n\n    try {\n      setLoading(true);\n      setError(null);\n      const data = await getPastDueNotifications(userId);\n      setNotifications(data);\n    } catch (err) {\n      console.error('Failed to fetch past due notifications:', err);\n      setError(\n        err instanceof Error\n          ? err.message\n          : 'Failed to fetch past due notifications'\n      );\n    } finally {\n      setLoading(false);\n    }\n  }, [userId]);\n\n  /**\n   * Fetch unread notification count\n   */\n  const fetchUnreadCount = useCallback(async () => {\n    if (!userId) return;\n\n    try {\n      const count = await getUnreadNotificationCount(userId);\n      setUnreadCount(count);\n    } catch (err) {\n      console.error('Failed to fetch unread count:', err);\n    }\n  }, [userId]);\n\n  /**\n   * Mark a notification as sent\n   */\n  const markAsSent = useCallback(\n    async (id: number) => {\n      try {\n        const updated = await markNotificationAsSent(id);\n        setNotifications(prev => prev.map(n => (n.id === id ? updated : n)));\n        await fetchUnreadCount();\n      } catch (err) {\n        console.error('Failed to mark notification as sent:', err);\n        throw err;\n      }\n    },\n    [fetchUnreadCount]\n  );\n\n  /**\n   * Mark multiple notifications as sent\n   */\n  const markMultipleAsSent = useCallback(\n    async (ids: number[]) => {\n      if (ids.length === 0) return;\n\n      try {\n        const updated = await markMultipleNotificationsAsSent(ids);\n        const updatedMap = new Map(updated.map(n => [n.id, n]));\n\n        setNotifications(prev => prev.map(n => updatedMap.get(n.id) || n));\n        await fetchUnreadCount();\n      } catch (err) {\n        console.error('Failed to mark notifications as sent:', err);\n        throw err;\n      }\n    },\n    [fetchUnreadCount]\n  );\n\n  /**\n   * Mark all scheduled past-due notifications as sent\n   */\n  const markAllScheduledAsSent = useCallback(async () => {\n    const scheduledIds = notifications\n      .filter(n => n.status === 'scheduled' && isPastDue(n.due_date))\n      .map(n => n.id);\n\n    if (scheduledIds.length > 0) {\n      await markMultipleAsSent(scheduledIds);\n    }\n  }, [notifications, markMultipleAsSent]);\n\n  /**\n   * Update notification status\n   */\n  const updateStatus = useCallback(\n    async (id: number, status: NotificationStatus) => {\n      try {\n        const updated = await updateNotificationStatus(id, status);\n        setNotifications(prev => prev.map(n => (n.id === id ? updated : n)));\n        await fetchUnreadCount();\n      } catch (err) {\n        console.error('Failed to update notification status:', err);\n        throw err;\n      }\n    },\n    [fetchUnreadCount]\n  );\n\n  /**\n   * Delete a notification\n   */\n  const deleteNotif = useCallback(\n    async (id: number) => {\n      try {\n        await deleteNotification(id);\n        setNotifications(prev => prev.filter(n => n.id !== id));\n        await fetchUnreadCount();\n      } catch (err) {\n        console.error('Failed to delete notification:', err);\n        throw err;\n      }\n    },\n    [fetchUnreadCount]\n  );\n\n  /**\n   * Initial fetch on mount - REMOVED to prevent infinite loops\n   * Each page/component should explicitly call fetch functions as needed\n   */\n  // useEffect(() => {\n  //   if (userId) {\n  //     fetchNotifications();\n  //     fetchUnreadCount();\n  //   }\n  // }, [userId, fetchNotifications, fetchUnreadCount]);\n\n  return {\n    notifications,\n    unreadCount,\n    loading,\n    error,\n    fetchNotifications,\n    fetchScheduledNotifications,\n    fetchPastDueNotifications,\n    fetchUnreadCount,\n    markAsSent,\n    markMultipleAsSent,\n    markAllScheduledAsSent,\n    updateStatus,\n    deleteNotif,\n    formatDate,\n    isPastDue,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 796, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/contexts/UIContext.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, ReactNode } from 'react';\n\ninterface UIContextType {\n  isThreadSidebarOpen: boolean;\n  isNotificationPanelOpen: boolean;\n  isInputActive: boolean;\n  toggleThreadSidebar: () => void;\n  toggleNotificationPanel: () => void;\n  closeThreadSidebar: () => void;\n  closeNotificationPanel: () => void;\n  setInputActive: (active: boolean) => void;\n}\n\nconst UIContext = createContext<UIContextType | undefined>(undefined);\n\nexport function UIProvider({ children }: { children: ReactNode }) {\n  const [isThreadSidebarOpen, setIsThreadSidebarOpen] = useState(false);\n  const [isNotificationPanelOpen, setIsNotificationPanelOpen] = useState(false);\n  const [isInputActive, setIsInputActive] = useState(false);\n\n  const toggleThreadSidebar = () => {\n    setIsThreadSidebarOpen(prev => !prev);\n    // Close notification panel if open\n    if (!isThreadSidebarOpen && isNotificationPanelOpen) {\n      setIsNotificationPanelOpen(false);\n    }\n  };\n\n  const toggleNotificationPanel = () => {\n    setIsNotificationPanelOpen(prev => !prev);\n  };\n\n  const closeThreadSidebar = () => setIsThreadSidebarOpen(false);\n  const closeNotificationPanel = () => setIsNotificationPanelOpen(false);\n  const setInputActive = (active: boolean) => setIsInputActive(active);\n\n  return (\n    <UIContext.Provider\n      value={{\n        isThreadSidebarOpen,\n        isNotificationPanelOpen,\n        isInputActive,\n        toggleThreadSidebar,\n        toggleNotificationPanel,\n        closeThreadSidebar,\n        closeNotificationPanel,\n        setInputActive,\n      }}\n    >\n      {children}\n    </UIContext.Provider>\n  );\n}\n\nexport function useUI() {\n  const context = useContext(UIContext);\n  if (context === undefined) {\n    throw new Error('useUI must be used within a UIProvider');\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;;;AAFA;;AAeA,MAAM,0BAAY,IAAA,kaAAa,EAA4B;AAEpD,SAAS,WAAW,KAAqC;QAArC,EAAE,QAAQ,EAA2B,GAArC;;IACzB,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,6ZAAQ,EAAC;IAC/D,MAAM,CAAC,yBAAyB,2BAA2B,GAAG,IAAA,6ZAAQ,EAAC;IACvE,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,6ZAAQ,EAAC;IAEnD,MAAM,sBAAsB;QAC1B,uBAAuB,CAAA,OAAQ,CAAC;QAChC,mCAAmC;QACnC,IAAI,CAAC,uBAAuB,yBAAyB;YACnD,2BAA2B;QAC7B;IACF;IAEA,MAAM,0BAA0B;QAC9B,2BAA2B,CAAA,OAAQ,CAAC;IACtC;IAEA,MAAM,qBAAqB,IAAM,uBAAuB;IACxD,MAAM,yBAAyB,IAAM,2BAA2B;IAChE,MAAM,iBAAiB,CAAC,SAAoB,iBAAiB;IAE7D,qBACE,ibAAC,UAAU,QAAQ;QACjB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;GArCgB;KAAA;AAuCT,SAAS;;IACd,MAAM,UAAU,IAAA,+ZAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB","debugId":null}},
    {"offset": {"line": 866, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS;IAAG,IAAA,IAAA,OAAA,UAAA,QAAA,AAAG,SAAH,UAAA,OAAA,OAAA,GAAA,OAAA,MAAA;QAAG,OAAH,QAAA,SAAA,CAAA,KAAuB;;IACxC,OAAO,IAAA,8NAAO,EAAC,IAAA,uOAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 887, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/ui/avatar.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport * as AvatarPrimitive from '@radix-ui/react-avatar';\nimport NextImage from 'next/image';\n\nimport { cn } from '@/lib/utils';\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      'relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full border border-white/20 bg-white/5 text-white',\n      className\n    )}\n    {...props}\n  />\n));\nAvatar.displayName = AvatarPrimitive.Root.displayName;\n\ntype AvatarImageProps = React.ComponentPropsWithoutRef<\n  typeof AvatarPrimitive.Image\n> & {\n  src: string;\n  alt: string;\n  priority?: boolean;\n  sizes?: string;\n  quality?: number;\n};\n\nconst AvatarImageComponent = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  AvatarImageProps\n>(\n  (\n    {\n      className,\n      src,\n      alt,\n      priority = false,\n      sizes = '40px',\n      quality = 85,\n      ...props\n    },\n    ref\n  ) => (\n    <AvatarPrimitive.Image\n      ref={ref}\n      asChild\n      src={src}\n      alt={alt}\n      className={cn('relative block h-full w-full overflow-hidden', className)}\n      {...props}\n    >\n      <NextImage\n        src={src}\n        alt={alt}\n        fill\n        sizes={sizes}\n        priority={priority}\n        quality={quality}\n        loading={priority ? undefined : 'lazy'}\n        className='object-cover'\n      />\n    </AvatarPrimitive.Image>\n  )\n);\n\nAvatarImageComponent.displayName = AvatarPrimitive.Image.displayName;\n\nconst AvatarImage = React.memo(\n  AvatarImageComponent,\n  (prev, next) =>\n    prev.src === next.src &&\n    prev.alt === next.alt &&\n    prev.priority === next.priority &&\n    prev.sizes === next.sizes &&\n    prev.quality === next.quality &&\n    prev.className === next.className\n);\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      'flex h-full w-full items-center justify-center rounded-full bg-white/10 text-sm font-medium',\n      className\n    )}\n    {...props}\n  />\n));\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName;\n\nexport { Avatar, AvatarImage, AvatarFallback };\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,uBAAS,+ZAAgB,MAG7B,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,ibAAC,6aAAoB;QACnB,KAAK;QACL,WAAW,IAAA,iLAAE,EACX,8GACA;QAED,GAAG,KAAK;;;;;;;;AAGb,OAAO,WAAW,GAAG,6aAAoB,CAAC,WAAW;AAYrD,MAAM,qCAAuB,+ZAAgB,OAI3C,QAUE;QATA,EACE,SAAS,EACT,GAAG,EACH,GAAG,EACH,WAAW,KAAK,EAChB,QAAQ,MAAM,EACd,UAAU,EAAE,EACZ,GAAG,OACJ;yBAGD,ibAAC,8aAAqB;QACpB,KAAK;QACL,OAAO;QACP,KAAK;QACL,KAAK;QACL,WAAW,IAAA,iLAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;kBAET,cAAA,ibAAC,+XAAS;YACR,KAAK;YACL,KAAK;YACL,IAAI;YACJ,OAAO;YACP,UAAU;YACV,SAAS;YACT,SAAS,WAAW,YAAY;YAChC,WAAU;;;;;;;;;;;;;AAMlB,qBAAqB,WAAW,GAAG,8aAAqB,CAAC,WAAW;AAEpE,MAAM,4BAAc,yZAAU,CAC5B,sBACA,CAAC,MAAM,OACL,KAAK,GAAG,KAAK,KAAK,GAAG,IACrB,KAAK,GAAG,KAAK,KAAK,GAAG,IACrB,KAAK,QAAQ,KAAK,KAAK,QAAQ,IAC/B,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,KAAK,OAAO,KAAK,KAAK,OAAO,IAC7B,KAAK,SAAS,KAAK,KAAK,SAAS;;AAGrC,MAAM,+BAAiB,+ZAAgB,OAGrC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,ibAAC,ibAAwB;QACvB,KAAK;QACL,WAAW,IAAA,iLAAE,EACX,+FACA;QAED,GAAG,KAAK;;;;;;;;AAGb,eAAe,WAAW,GAAG,ibAAwB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 983, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/ui/dropdown-menu.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu';\nimport { Check, ChevronRight, Circle } from 'lucide-react';\n\nimport { cn } from '@/lib/utils';\n\nconst DropdownMenu = DropdownMenuPrimitive.Root;\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group;\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal;\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub;\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean;\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      'flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm font-medium outline-none transition-colors hover:bg-white/10 hover:text-white focus:bg-white/10 data-[state=open]:bg-white/10',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className='ml-auto h-4 w-4' />\n  </DropdownMenuPrimitive.SubTrigger>\n));\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName;\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      'z-50 min-w-[8rem] overflow-hidden rounded-md border border-white/10 bg-black/90 p-1 text-white shadow-lg backdrop-blur',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName;\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, collisionPadding = 8, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      collisionPadding={collisionPadding}\n      className={cn(\n        'z-50 min-w-[12rem] overflow-hidden rounded-lg border border-white/10 bg-black/90 p-1 text-white shadow-xl backdrop-blur',\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[side=bottom]:slide-in-from-top-2 data-[side=top]:slide-in-from-bottom-2',\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n));\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      'relative flex cursor-pointer select-none items-center rounded-md px-2 py-1.5 text-sm outline-none transition-colors hover:bg-white/10 hover:text-white focus:bg-white/10 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      'relative flex cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-white/10 hover:text-white focus:bg-white/10 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className='absolute left-2 flex h-3.5 w-3.5 items-center justify-center'>\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className='h-4 w-4' />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n));\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName;\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      'relative flex cursor-pointer select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors hover:bg-white/10 hover:text-white focus:bg-white/10 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50',\n      className\n    )}\n    {...props}\n  >\n    <span className='absolute left-2 flex h-3.5 w-3.5 items-center justify-center'>\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className='h-2 w-2 fill-current' />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n));\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean;\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      'px-2 py-1.5 text-xs font-semibold text-white/70',\n      inset && 'pl-8',\n      className\n    )}\n    {...props}\n  />\n));\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn('-mx-1 my-1 h-px bg-white/10', className)}\n    {...props}\n  />\n));\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn('ml-auto text-xs tracking-widest text-white/40', className)}\n      {...props}\n    />\n  );\n};\nDropdownMenuShortcut.displayName = 'DropdownMenuShortcut';\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1250, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/ui/button.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { Slot } from '@radix-ui/react-slot';\nimport { cva, type VariantProps } from 'class-variance-authority';\n\nimport { cn } from '@/lib/utils';\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background',\n  {\n    variants: {\n      variant: {\n        default:\n          'bg-white/10 text-white hover:bg-white/20 shadow-sm border border-white/10',\n        secondary:\n          'bg-slate-900 text-white hover:bg-slate-800 border border-white/5',\n        outline:\n          'border border-white/20 bg-transparent text-white hover:bg-white/10',\n        ghost: 'text-white hover:bg-white/10',\n        destructive:\n          'bg-red-600 text-white hover:bg-red-500 border border-red-500/80',\n      },\n      size: {\n        default: 'h-9 px-4 py-2',\n        sm: 'h-8 rounded-md px-3',\n        lg: 'h-10 rounded-md px-8',\n        icon: 'h-9 w-9',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  }\n);\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean;\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button';\n\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    );\n  }\n);\nButton.displayName = 'Button';\n\nexport { Button, buttonVariants };\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,iBAAiB,IAAA,+NAAG,EACxB,+RACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,SACE;YACF,OAAO;YACP,aACE;QACJ;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,+ZAAgB,MAC7B,QAA0D;QAAzD,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO;IACtD,MAAM,OAAO,UAAU,gOAAI,GAAG;IAE9B,qBACE,ibAAC;QACC,WAAW,IAAA,iLAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 1318, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/features/auth/api/supabaseAuth.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/browserClient';\n\nconst supabase = createClient();\n\nexport async function signUp(\n  email: string,\n  password: string,\n  emailRedirectTo?: string\n) {\n  const { data, error } = await supabase.auth.signUp({\n    email,\n    password,\n    options: {\n      emailRedirectTo:\n        emailRedirectTo ||\n        (typeof window !== 'undefined'\n          ? `${window.location.origin}/auth/callback`\n          : undefined),\n    },\n  });\n  if (error) throw error;\n  return data;\n}\n\nexport async function signIn(email: string, password: string) {\n  const { data, error } = await supabase.auth.signInWithPassword({\n    email,\n    password,\n  });\n  if (error) throw error;\n  return data;\n}\n\nexport async function signInWithGoogle(emailRedirectTo?: string) {\n  const redirectTo =\n    emailRedirectTo ||\n    (typeof window !== 'undefined'\n      ? `${window.location.origin}/auth/callback`\n      : undefined);\n\n  const { data, error } = await supabase.auth.signInWithOAuth({\n    provider: 'google',\n    options: {\n      redirectTo,\n      queryParams: {\n        access_type: 'offline',\n        prompt: 'consent',\n      },\n    },\n  });\n  if (error) throw error;\n  return data;\n}\n\nexport async function signOut() {\n  const { error } = await supabase.auth.signOut();\n  if (error) throw error;\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAEA,MAAM,WAAW,IAAA,+MAAY;AAEtB,eAAe,OACpB,KAAa,EACb,QAAgB,EAChB,eAAwB;IAExB,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,MAAM,CAAC;QACjD;QACA;QACA,SAAS;YACP,iBACE,mBACA,CAAC,uCACG,AAAC,GAAyB,OAAvB,OAAO,QAAQ,CAAC,MAAM,EAAC,oBAC1B,uBAAS;QACjB;IACF;IACA,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,OAAO,KAAa,EAAE,QAAgB;IAC1D,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,kBAAkB,CAAC;QAC7D;QACA;IACF;IACA,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,iBAAiB,eAAwB;IAC7D,MAAM,aACJ,mBACA,CAAC,uCACG,AAAC,GAAyB,OAAvB,OAAO,QAAQ,CAAC,MAAM,EAAC,oBAC1B,uBAAS;IAEf,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,eAAe,CAAC;QAC1D,UAAU;QACV,SAAS;YACP;YACA,aAAa;gBACX,aAAa;gBACb,QAAQ;YACV;QACF;IACF;IACA,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAC7C,IAAI,OAAO,MAAM;AACnB","debugId":null}},
    {"offset": {"line": 1376, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/api/userProfilesApi.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/browserClient';\nimport type { UserProfile, UserProfileUpdateInput } from '@/types/userProfile';\n\nconst supabase = createClient();\n\nconst AVATAR_BUCKET = 'avatars';\n\nfunction extractStoragePathFromUrl(url: string): string | null {\n  try {\n    const parsed = new URL(url);\n    const parts = parsed.pathname.split('/');\n    const bucketIndex = parts.findIndex(part => part === AVATAR_BUCKET);\n    if (bucketIndex === -1) return null;\n    return parts.slice(bucketIndex + 1).join('/');\n  } catch (error) {\n    console.warn('Failed to parse avatar URL', error);\n    return null;\n  }\n}\n\nexport async function getUserProfile(\n  userId: string\n): Promise<UserProfile | null> {\n  const { data, error } = await supabase\n    .from('user_profiles')\n    .select('*')\n    .eq('id', userId)\n    .maybeSingle();\n\n  if (error) throw error;\n  return data ?? null;\n}\n\nexport async function createUserProfile(userId: string): Promise<UserProfile> {\n  const { data, error } = await supabase\n    .from('user_profiles')\n    .insert({ id: userId })\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function updateUserProfile(\n  userId: string,\n  updates: UserProfileUpdateInput\n): Promise<UserProfile> {\n  const payload = {\n    ...updates,\n    updated_at: new Date().toISOString(),\n  };\n\n  const { data, error } = await supabase\n    .from('user_profiles')\n    .update(payload)\n    .eq('id', userId)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function uploadUserAvatar(\n  userId: string,\n  file: File | Blob,\n  previousAvatarUrl?: string | null\n): Promise<{ avatarUrl: string; path: string }> {\n  const fileExt = file instanceof File ? file.name.split('.').pop() : 'png';\n  const extension = fileExt\n    ? fileExt.replace(/[^a-zA-Z0-9]/g, '') || 'png'\n    : 'png';\n  const filePath = `${userId}/${crypto.randomUUID()}.${extension}`;\n\n  const { error: uploadError } = await supabase.storage\n    .from(AVATAR_BUCKET)\n    .upload(filePath, file, {\n      cacheControl: '3600',\n      upsert: true,\n    });\n\n  if (uploadError) throw uploadError;\n\n  const {\n    data: { publicUrl },\n  } = supabase.storage.from(AVATAR_BUCKET).getPublicUrl(filePath);\n\n  if (previousAvatarUrl) {\n    const oldPath = extractStoragePathFromUrl(previousAvatarUrl);\n    if (oldPath) {\n      void supabase.storage.from(AVATAR_BUCKET).remove([oldPath]);\n    }\n  }\n\n  return { avatarUrl: publicUrl, path: filePath };\n}\n\nexport async function removeUserAvatar(\n  userId: string,\n  currentAvatarUrl?: string | null\n): Promise<UserProfile> {\n  if (currentAvatarUrl) {\n    const path = extractStoragePathFromUrl(currentAvatarUrl);\n    if (path) {\n      await supabase.storage.from(AVATAR_BUCKET).remove([path]);\n    }\n  }\n\n  return updateUserProfile(userId, { avatar_url: null });\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAGA,MAAM,WAAW,IAAA,+MAAY;AAE7B,MAAM,gBAAgB;AAEtB,SAAS,0BAA0B,GAAW;IAC5C,IAAI;QACF,MAAM,SAAS,IAAI,IAAI;QACvB,MAAM,QAAQ,OAAO,QAAQ,CAAC,KAAK,CAAC;QACpC,MAAM,cAAc,MAAM,SAAS,CAAC,CAAA,OAAQ,SAAS;QACrD,IAAI,gBAAgB,CAAC,GAAG,OAAO;QAC/B,OAAO,MAAM,KAAK,CAAC,cAAc,GAAG,IAAI,CAAC;IAC3C,EAAE,OAAO,OAAO;QACd,QAAQ,IAAI,CAAC,8BAA8B;QAC3C,OAAO;IACT;AACF;AAEO,eAAe,eACpB,MAAc;IAEd,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,QACT,WAAW;IAEd,IAAI,OAAO,MAAM;IACjB,OAAO,iBAAA,kBAAA,OAAQ;AACjB;AAEO,eAAe,kBAAkB,MAAc;IACpD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC;QAAE,IAAI;IAAO,GACpB,MAAM,GACN,MAAM;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,kBACpB,MAAc,EACd,OAA+B;IAE/B,MAAM,UAAU;QACd,GAAG,OAAO;QACV,YAAY,IAAI,OAAO,WAAW;IACpC;IAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,iBACL,MAAM,CAAC,SACP,EAAE,CAAC,MAAM,QACT,MAAM,GACN,MAAM;IAET,IAAI,OAAO,MAAM;IACjB,OAAO;AACT;AAEO,eAAe,iBACpB,MAAc,EACd,IAAiB,EACjB,iBAAiC;IAEjC,MAAM,UAAU,gBAAgB,OAAO,KAAK,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,KAAK;IACpE,MAAM,YAAY,UACd,QAAQ,OAAO,CAAC,iBAAiB,OAAO,QACxC;IACJ,MAAM,WAAW,AAAC,GAAY,OAAV,QAAO,KAA0B,OAAvB,OAAO,UAAU,IAAG,KAAa,OAAV;IAErD,MAAM,EAAE,OAAO,WAAW,EAAE,GAAG,MAAM,SAAS,OAAO,CAClD,IAAI,CAAC,eACL,MAAM,CAAC,UAAU,MAAM;QACtB,cAAc;QACd,QAAQ;IACV;IAEF,IAAI,aAAa,MAAM;IAEvB,MAAM,EACJ,MAAM,EAAE,SAAS,EAAE,EACpB,GAAG,SAAS,OAAO,CAAC,IAAI,CAAC,eAAe,YAAY,CAAC;IAEtD,IAAI,mBAAmB;QACrB,MAAM,UAAU,0BAA0B;QAC1C,IAAI,SAAS;YACX,KAAK,SAAS,OAAO,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC;gBAAC;aAAQ;QAC5D;IACF;IAEA,OAAO;QAAE,WAAW;QAAW,MAAM;IAAS;AAChD;AAEO,eAAe,iBACpB,MAAc,EACd,gBAAgC;IAEhC,IAAI,kBAAkB;QACpB,MAAM,OAAO,0BAA0B;QACvC,IAAI,MAAM;YACR,MAAM,SAAS,OAAO,CAAC,IAAI,CAAC,eAAe,MAAM,CAAC;gBAAC;aAAK;QAC1D;IACF;IAEA,OAAO,kBAAkB,QAAQ;QAAE,YAAY;IAAK;AACtD","debugId":null}},
    {"offset": {"line": 1468, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/hooks/useUserProfile.ts"],"sourcesContent":["'use client';\n\nimport { useCallback, useEffect, useMemo, useState } from 'react';\n\nimport {\n  createUserProfile,\n  getUserProfile,\n  updateUserProfile,\n} from '@/lib/api/userProfilesApi';\nimport type { UserProfile, UserProfileUpdateInput } from '@/types/userProfile';\n\ntype UseUserProfileOptions = {\n  userId?: string | null;\n  loadOnInit?: boolean;\n};\n\nexport function useUserProfile({\n  userId,\n  loadOnInit = true,\n}: UseUserProfileOptions) {\n  const [profile, setProfile] = useState<UserProfile | null>(null);\n  const [loading, setLoading] = useState<boolean>(!!userId && loadOnInit);\n  const [error, setError] = useState<string | null>(null);\n\n  const fetchProfile = useCallback(async () => {\n    if (!userId) return null;\n\n    try {\n      setLoading(true);\n      setError(null);\n      let data = await getUserProfile(userId);\n\n      if (!data) {\n        data = await createUserProfile(userId);\n      }\n\n      setProfile(data);\n      return data;\n    } catch (err) {\n      console.error('Failed to load user profile', err);\n      setError(\n        err instanceof Error ? err.message : 'Failed to load user profile'\n      );\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  }, [userId]);\n\n  const updateProfile = useCallback(\n    async (updates: UserProfileUpdateInput) => {\n      if (!userId) {\n        throw new Error('Cannot update profile without a user id');\n      }\n\n      const updated = await updateUserProfile(userId, updates);\n      setProfile(updated);\n      return updated;\n    },\n    [userId]\n  );\n\n  useEffect(() => {\n    if (userId && loadOnInit) {\n      void fetchProfile();\n    }\n  }, [userId, loadOnInit, fetchProfile]);\n\n  const value = useMemo(\n    () => ({ profile, loading, error }),\n    [profile, loading, error]\n  );\n\n  return {\n    ...value,\n    refresh: fetchProfile,\n    updateProfile,\n  };\n}\n"],"names":[],"mappings":";;;;AAEA;AAEA;;AAJA;;;AAgBO,SAAS,eAAe,KAGP;QAHO,EAC7B,MAAM,EACN,aAAa,IAAI,EACK,GAHO;;IAI7B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6ZAAQ,EAAqB;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6ZAAQ,EAAU,CAAC,CAAC,UAAU;IAC5D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6ZAAQ,EAAgB;IAElD,MAAM,eAAe,IAAA,gaAAW;oDAAC;YAC/B,IAAI,CAAC,QAAQ,OAAO;YAEpB,IAAI;gBACF,WAAW;gBACX,SAAS;gBACT,IAAI,OAAO,MAAM,IAAA,8MAAc,EAAC;gBAEhC,IAAI,CAAC,MAAM;oBACT,OAAO,MAAM,IAAA,iNAAiB,EAAC;gBACjC;gBAEA,WAAW;gBACX,OAAO;YACT,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,+BAA+B;gBAC7C,SACE,eAAe,QAAQ,IAAI,OAAO,GAAG;gBAEvC,MAAM;YACR,SAAU;gBACR,WAAW;YACb;QACF;mDAAG;QAAC;KAAO;IAEX,MAAM,gBAAgB,IAAA,gaAAW;qDAC/B,OAAO;YACL,IAAI,CAAC,QAAQ;gBACX,MAAM,IAAI,MAAM;YAClB;YAEA,MAAM,UAAU,MAAM,IAAA,iNAAiB,EAAC,QAAQ;YAChD,WAAW;YACX,OAAO;QACT;oDACA;QAAC;KAAO;IAGV,IAAA,8ZAAS;oCAAC;YACR,IAAI,UAAU,YAAY;gBACxB,KAAK;YACP;QACF;mCAAG;QAAC;QAAQ;QAAY;KAAa;IAErC,MAAM,QAAQ,IAAA,4ZAAO;yCACnB,IAAM,CAAC;gBAAE;gBAAS;gBAAS;YAAM,CAAC;wCAClC;QAAC;QAAS;QAAS;KAAM;IAG3B,OAAO;QACL,GAAG,KAAK;QACR,SAAS;QACT;IACF;AACF;GA9DgB","debugId":null}},
    {"offset": {"line": 1555, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/layout/UserMenu.tsx"],"sourcesContent":["'use client';\n\nimport * as React from 'react';\nimport { LogOut, Settings } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport type { User } from '@supabase/supabase-js';\n\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\nimport { Button } from '@/components/ui/button';\nimport { signOut } from '@/features/auth/api/supabaseAuth';\nimport { useUserProfile } from '@/hooks/useUserProfile';\nimport type { UserProfile } from '@/types/userProfile';\n\ntype UserMenuProps = {\n  user: User | null;\n};\n\nfunction getInitials(profile?: UserProfile | null, email?: string | null) {\n  const name = profile?.name;\n  if (name && name.trim().length > 0) {\n    const parts = name.trim().split(' ');\n    if (parts.length === 1) {\n      return parts[0]?.slice(0, 2).toUpperCase();\n    }\n    return `${parts[0]?.[0] ?? ''}${parts[1]?.[0] ?? ''}`.toUpperCase();\n  }\n  if (email) {\n    return email.slice(0, 2).toUpperCase();\n  }\n  return 'ME';\n}\n\nexport function UserMenu({ user }: UserMenuProps) {\n  const router = useRouter();\n  const [open, setOpen] = React.useState(false);\n  const [isSigningOut, setIsSigningOut] = React.useState(false);\n  const hoverTimeoutRef = React.useRef<number | null>(null);\n  const userId = user?.id ?? null;\n  const { profile } = useUserProfile({ userId });\n\n  const email = user?.email ?? 'Unknown user';\n  const avatarUrl = profile?.avatar_url ?? null;\n  const initials = getInitials(profile, email);\n\n  const handleSelectSettings = React.useCallback(() => {\n    setOpen(false);\n    router.push('/user/settings');\n  }, [router]);\n\n  const handleSignOut = React.useCallback(async () => {\n    setIsSigningOut(true);\n    try {\n      await signOut();\n      router.push('/login');\n    } catch (error) {\n      console.error('Failed to sign out', error);\n    } finally {\n      setIsSigningOut(false);\n      setOpen(false);\n    }\n  }, [router]);\n\n  const clearHoverTimeout = () => {\n    if (hoverTimeoutRef.current) {\n      window.clearTimeout(hoverTimeoutRef.current);\n      hoverTimeoutRef.current = null;\n    }\n  };\n\n  const scheduleClose = () => {\n    clearHoverTimeout();\n    hoverTimeoutRef.current = window.setTimeout(() => {\n      setOpen(false);\n    }, 120);\n  };\n\n  const handleMouseEnter = () => {\n    clearHoverTimeout();\n    setOpen(true);\n  };\n\n  const handleMouseLeave = () => {\n    scheduleClose();\n  };\n\n  React.useEffect(() => {\n    return () => clearHoverTimeout();\n  }, []);\n\n  return (\n    <DropdownMenu open={open} onOpenChange={setOpen} modal={false}>\n      <div\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n        className='relative'\n      >\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant='ghost'\n            size='icon'\n            className='h-10 w-10 rounded-full border border-white/10 bg-white/5 text-white hover:bg-white/15'\n            aria-label='Open user menu'\n          >\n            <Avatar className='h-9 w-9'>\n              {avatarUrl ? (\n                <AvatarImage src={avatarUrl} alt={profile?.name || email} />\n              ) : (\n                <AvatarFallback>{initials}</AvatarFallback>\n              )}\n            </Avatar>\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent\n          align='end'\n          sideOffset={12}\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          className='w-60'\n        >\n          <DropdownMenuLabel className='flex flex-col gap-1'>\n            <span className='text-sm font-semibold'>\n              {profile?.name || initials}\n            </span>\n            <span className='text-xs text-white/60'>{email}</span>\n          </DropdownMenuLabel>\n          <DropdownMenuSeparator />\n          <DropdownMenuItem\n            onSelect={event => {\n              event.preventDefault();\n              handleSelectSettings();\n            }}\n            className='flex items-center gap-2'\n          >\n            <Settings className='h-4 w-4' />\n            <span>User settings</span>\n          </DropdownMenuItem>\n          <DropdownMenuSeparator />\n          <DropdownMenuItem\n            onSelect={event => {\n              event.preventDefault();\n              if (!isSigningOut) {\n                handleSignOut();\n              }\n            }}\n            className='flex items-center gap-2 text-red-300'\n          >\n            <LogOut className='h-4 w-4' />\n            <span>{isSigningOut ? 'Signing out' : 'Log out'}</span>\n          </DropdownMenuItem>\n        </DropdownMenuContent>\n      </div>\n    </DropdownMenu>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1843, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/layout/Header.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { usePathname } from 'next/navigation';\nimport { useThreads } from '@/hooks/useThreads';\nimport { useThreadContext } from '@/contexts/ThreadContext';\nimport { useNotifications } from '@/hooks/useNotifications';\nimport { useUI } from '@/contexts/UIContext';\nimport { createClient } from '@/lib/supabase/browserClient';\nimport type { User } from '@supabase/supabase-js';\nimport { UserMenu } from '@/components/layout/UserMenu';\nimport { BellIcon } from 'lucide-react';\n\nexport default function Header() {\n  const pathname = usePathname();\n  const isHomePage = pathname === '/home';\n  const pageTitleMap: Record<string, string> = {\n    '/notes': 'Notes',\n    '/workspace': 'Workspaces',\n    '/personal': 'Personal',\n    '/user/settings': 'User Settings',\n  };\n  const pageTitle = pageTitleMap[pathname] ?? null;\n  const { createThread } = useThreads();\n  const { setSelectedThreadId } = useThreadContext();\n  const { toggleThreadSidebar, toggleNotificationPanel } = useUI();\n  const [user, setUser] = useState<User | null>(null);\n  const [isMounted, setIsMounted] = useState(false);\n  const [currentTime, setCurrentTime] = useState('');\n\n  // Get notifications hook\n  const userId = user?.id ?? null;\n  const { unreadCount, fetchUnreadCount } = useNotifications(\n    userId || undefined\n  );\n\n  // Initialize on mount: set mounted flag and get userId\n  useEffect(() => {\n    setIsMounted(true);\n\n    const getUserData = async () => {\n      const supabase = createClient();\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      if (user) {\n        setUser(user);\n      }\n    };\n    getUserData();\n  }, []);\n\n  // Update time every minute\n  useEffect(() => {\n    const updateTime = () => {\n      const now = new Date();\n      const formatted = now\n        .toLocaleString('en-US', {\n          weekday: 'short',\n          month: 'short',\n          day: 'numeric',\n          hour: '2-digit',\n          minute: '2-digit',\n          hour12: false,\n        })\n        .replace(/,/g, '');\n      setCurrentTime(formatted);\n    };\n\n    updateTime();\n    const interval = setInterval(updateTime, 60000); // Update every minute\n\n    return () => clearInterval(interval);\n  }, []);\n\n  // Poll for unread notifications every 30 seconds\n  useEffect(() => {\n    if (!userId) return;\n\n    fetchUnreadCount();\n    const interval = setInterval(() => {\n      fetchUnreadCount();\n    }, 30000);\n\n    return () => clearInterval(interval);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [userId]);\n\n  const handleCreateThread = async () => {\n    try {\n      const now = new Date();\n      const dateTimeTitle = now.toLocaleString('en-US', {\n        month: 'short',\n        day: 'numeric',\n        year: 'numeric',\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: true,\n      });\n\n      const newThread = await createThread(dateTimeTitle);\n      // Auto-select the newly created thread\n      if (newThread && newThread.id) {\n        setSelectedThreadId(newThread.id);\n      }\n    } catch (error) {\n      console.error('Failed to create thread:', error);\n    }\n  };\n\n  return (\n    <header className='flex items-center justify-between px-4 md:px-6 py-3 border-b border-black bg-white/3 backdrop-blur-lg relative z-50'>\n      {/* Left Side - Thread Controls + Logo */}\n      <div className='flex items-center gap-4'>\n        {isHomePage && isMounted && (\n          <div className='flex items-center gap-2'>\n            {/* Thread Sidebar Toggle */}\n            <button\n              onClick={toggleThreadSidebar}\n              className='flex items-center gap-1.5 text-white/60 hover:text-white transition-colors group'\n              title='Threads'\n            >\n              <svg\n                xmlns='http://www.w3.org/2000/svg'\n                fill='none'\n                viewBox='0 0 24 24'\n                strokeWidth={2}\n                stroke='currentColor'\n                className='w-5 h-5'\n              >\n                <path\n                  strokeLinecap='round'\n                  strokeLinejoin='round'\n                  d='M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5'\n                />\n              </svg>\n            </button>\n\n            {/* New Thread Button */}\n            <button\n              onClick={handleCreateThread}\n              className='flex items-center gap-2 text-white/60 hover:text-white transition-colors group'\n              title='New Thread'\n            >\n              <svg\n                xmlns='http://www.w3.org/2000/svg'\n                fill='none'\n                viewBox='0 0 24 24'\n                strokeWidth={2}\n                stroke='currentColor'\n                className='w-5 h-5'\n              >\n                <path\n                  strokeLinecap='round'\n                  strokeLinejoin='round'\n                  d='M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10'\n                />\n              </svg>\n            </button>\n\n            {/* Divider */}\n            <div className='w-px h-5 bg-white/20'></div>\n          </div>\n        )}\n\n        {/* Logo */}\n        <h1\n          className={`text-lg font-semibold text-white ${pathname === '/workspace' || pathname === '/notes' ? 'ml-2' : ''}`}\n        >\n          Cogno\n          {pageTitle && (\n            <span className='text-base text-white/60 font-normal'>\n              {' '}\n              | {pageTitle}\n            </span>\n          )}\n        </h1>\n      </div>\n\n      <div className='flex items-center gap-3'>\n        {isHomePage && isMounted && (\n          <button\n            onClick={toggleNotificationPanel}\n            data-notification-trigger='true'\n            className='flex items-center gap-2 text-white/60 hover:text-white transition-colors group relative'\n          >\n            <span className='text-sm font-medium'>{currentTime}</span>\n            <BellIcon className='h-5 w-5' />\n            {/* Cogno Icon (Star/Comet) */}\n            <div className='relative'>\n              {/* <div className='w-2 h-2 bg-white rounded-full'></div>\n              <div className='absolute top-1/2 left-0 w-6 h-0.5 bg-gradient-to-r from-white/50 via-white/20 to-transparent transform -translate-y-1/2'></div> */}\n              {/* Unread Badge */}\n              {unreadCount > 0 && (\n                <span className='absolute -top-1 -right-1 bg-red-500 text-white text-[9px] font-bold rounded-full min-w-[14px] h-[14px] flex items-center justify-center px-0.5 border border-black/50'>\n                  {unreadCount > 9 ? '9+' : unreadCount}\n                </span>\n              )}\n            </div>\n          </button>\n        )}\n        {isMounted && <UserMenu user={user} />}\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;;AAXA;;;;;;;;;;AAae,SAAS;;IACtB,MAAM,WAAW,IAAA,wYAAW;IAC5B,MAAM,aAAa,aAAa;IAChC,MAAM,eAAuC;QAC3C,UAAU;QACV,cAAc;QACd,aAAa;QACb,kBAAkB;IACpB;QACkB;IAAlB,MAAM,YAAY,CAAA,yBAAA,YAAY,CAAC,SAAS,cAAtB,oCAAA,yBAA0B;IAC5C,MAAM,EAAE,YAAY,EAAE,GAAG,IAAA,gMAAU;IACnC,MAAM,EAAE,mBAAmB,EAAE,GAAG,IAAA,6MAAgB;IAChD,MAAM,EAAE,mBAAmB,EAAE,uBAAuB,EAAE,GAAG,IAAA,8LAAK;IAC9D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,6ZAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6ZAAQ,EAAC;IAC3C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6ZAAQ,EAAC;QAGhC;IADf,yBAAyB;IACzB,MAAM,SAAS,CAAA,WAAA,iBAAA,2BAAA,KAAM,EAAE,cAAR,sBAAA,WAAY;IAC3B,MAAM,EAAE,WAAW,EAAE,gBAAgB,EAAE,GAAG,IAAA,4MAAgB,EACxD,UAAU;IAGZ,uDAAuD;IACvD,IAAA,8ZAAS;4BAAC;YACR,aAAa;YAEb,MAAM;gDAAc;oBAClB,MAAM,WAAW,IAAA,+MAAY;oBAC7B,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;oBAC/B,IAAI,MAAM;wBACR,QAAQ;oBACV;gBACF;;YACA;QACF;2BAAG,EAAE;IAEL,2BAA2B;IAC3B,IAAA,8ZAAS;4BAAC;YACR,MAAM;+CAAa;oBACjB,MAAM,MAAM,IAAI;oBAChB,MAAM,YAAY,IACf,cAAc,CAAC,SAAS;wBACvB,SAAS;wBACT,OAAO;wBACP,KAAK;wBACL,MAAM;wBACN,QAAQ;wBACR,QAAQ;oBACV,GACC,OAAO,CAAC,MAAM;oBACjB,eAAe;gBACjB;;YAEA;YACA,MAAM,WAAW,YAAY,YAAY,QAAQ,sBAAsB;YAEvE;oCAAO,IAAM,cAAc;;QAC7B;2BAAG,EAAE;IAEL,iDAAiD;IACjD,IAAA,8ZAAS;4BAAC;YACR,IAAI,CAAC,QAAQ;YAEb;YACA,MAAM,WAAW;6CAAY;oBAC3B;gBACF;4CAAG;YAEH;oCAAO,IAAM,cAAc;;QAC3B,uDAAuD;QACzD;2BAAG;QAAC;KAAO;IAEX,MAAM,qBAAqB;QACzB,IAAI;YACF,MAAM,MAAM,IAAI;YAChB,MAAM,gBAAgB,IAAI,cAAc,CAAC,SAAS;gBAChD,OAAO;gBACP,KAAK;gBACL,MAAM;gBACN,MAAM;gBACN,QAAQ;gBACR,QAAQ;YACV;YAEA,MAAM,YAAY,MAAM,aAAa;YACrC,uCAAuC;YACvC,IAAI,aAAa,UAAU,EAAE,EAAE;gBAC7B,oBAAoB,UAAU,EAAE;YAClC;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,4BAA4B;QAC5C;IACF;IAEA,qBACE,ibAAC;QAAO,WAAU;;0BAEhB,ibAAC;gBAAI,WAAU;;oBACZ,cAAc,2BACb,ibAAC;wBAAI,WAAU;;0CAEb,ibAAC;gCACC,SAAS;gCACT,WAAU;gCACV,OAAM;0CAEN,cAAA,ibAAC;oCACC,OAAM;oCACN,MAAK;oCACL,SAAQ;oCACR,aAAa;oCACb,QAAO;oCACP,WAAU;8CAEV,cAAA,ibAAC;wCACC,eAAc;wCACd,gBAAe;wCACf,GAAE;;;;;;;;;;;;;;;;0CAMR,ibAAC;gCACC,SAAS;gCACT,WAAU;gCACV,OAAM;0CAEN,cAAA,ibAAC;oCACC,OAAM;oCACN,MAAK;oCACL,SAAQ;oCACR,aAAa;oCACb,QAAO;oCACP,WAAU;8CAEV,cAAA,ibAAC;wCACC,eAAc;wCACd,gBAAe;wCACf,GAAE;;;;;;;;;;;;;;;;0CAMR,ibAAC;gCAAI,WAAU;;;;;;;;;;;;kCAKnB,ibAAC;wBACC,WAAW,AAAC,oCAAoG,OAAjE,aAAa,gBAAgB,aAAa,WAAW,SAAS;;4BAC9G;4BAEE,2BACC,ibAAC;gCAAK,WAAU;;oCACb;oCAAI;oCACF;;;;;;;;;;;;;;;;;;;0BAMX,ibAAC;gBAAI,WAAU;;oBACZ,cAAc,2BACb,ibAAC;wBACC,SAAS;wBACT,6BAA0B;wBAC1B,WAAU;;0CAEV,ibAAC;gCAAK,WAAU;0CAAuB;;;;;;0CACvC,ibAAC,0QAAQ;gCAAC,WAAU;;;;;;0CAEpB,ibAAC;gCAAI,WAAU;0CAIZ,cAAc,mBACb,ibAAC;oCAAK,WAAU;8CACb,cAAc,IAAI,OAAO;;;;;;;;;;;;;;;;;oBAMnC,2BAAa,ibAAC,4MAAQ;wBAAC,MAAM;;;;;;;;;;;;;;;;;;AAItC;GAhMwB;;QACL,wYAAW;QASH,gMAAU;QACH,6MAAgB;QACS,8LAAK;QAOpB,4MAAgB;;;KAnBpC","debugId":null}},
    {"offset": {"line": 2162, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/components/layout/BottomNav.tsx"],"sourcesContent":["'use client';\n\nimport { usePathname, useRouter } from 'next/navigation';\nimport { useEffect } from 'react';\nimport { useUI } from '@/contexts/UIContext';\nimport { HomeIcon, MessageSquare } from 'lucide-react';\nimport { Notebook } from 'lucide-react';\n\nexport default function BottomNav() {\n  const pathname = usePathname();\n  const router = useRouter();\n  const { closeThreadSidebar } = useUI();\n\n  // /home\n  useEffect(() => {\n    if (!pathname.startsWith('/home')) {\n      closeThreadSidebar();\n    }\n  }, [pathname, closeThreadSidebar]);\n\n  const tabs = [\n    {\n      name: 'Chat',\n      path: '/workspace',\n      icon: <MessageSquare className='w-6 h-6' />,\n    },\n    { name: 'Cogno', path: '/home', icon: <HomeIcon className='w-6 h-6' /> },\n    { name: 'Notes', path: '/notes', icon: <Notebook className='w-6 h-6' /> },\n  ];\n\n  return (\n    <div className='border-t border-black bg-white/1 backdrop-blur-lg relative z-100'>\n      <div className='flex items-center justify-around py-4 px-4'>\n        {tabs.map(tab => {\n          const isActive = pathname.startsWith(tab.path);\n\n          return (\n            <button\n              key={tab.path}\n              onClick={() => router.push(tab.path)}\n              className={`flex flex-col items-center gap-2 transition-all duration-300 group ${\n                isActive ? 'text-white' : 'text-gray-400 hover:text-white'\n              }`}\n            >\n              {/* <div className='relative'>\n                <div\n                  className={`bg-white rounded-full shadow-lg transition-all duration-500 ease-out ${\n                    isActive\n                      ? 'w-3.5 h-3.5 scale-100'\n                      : 'w-2.5 h-2.5 scale-100 group-hover:scale-110'\n                  }`}\n                ></div>\n\n                <div\n                  className={`absolute top-1/2 left-0 transition-all duration-500 ease-out ${\n                    isActive\n                      ? 'opacity-100 translate-x-0'\n                      : 'opacity-0 -translate-x-2'\n                  }`}\n                >\n                  <div className='absolute top-1/2 left-0 w-10 h-0.5 bg-gradient-to-r from-white/60 via-white/30 to-transparent transform -translate-y-1/2'></div>\n                  <div className='absolute top-1/2 left-0 w-8 h-0.5 bg-gradient-to-r from-white/40 via-white/20 to-transparent transform -translate-y-1/2 translate-y-1.5'></div>\n                  <div className='absolute top-1/2 left-0 w-6 h-0.5 bg-gradient-to-r from-white/30 via-white/15 to-transparent transform -translate-y-1/2 -translate-y-1.5'></div>\n                  <div className='absolute top-1/2 left-0 w-4 h-0.5 bg-gradient-to-r from-white/20 via-white/10 to-transparent transform -translate-y-1/2 translate-y-2.5'></div>\n                </div>\n\n                <div\n                  className={`transition-all duration-500 ease-out ${\n                    isActive ? 'opacity-0 scale-75' : 'opacity-100 scale-100'\n                  }`}\n                >\n                  <div className='absolute top-1/2 left-1/2 w-8 h-0.5 bg-gradient-to-r from-transparent via-white/40 to-transparent transform -translate-x-1/2 -translate-y-1/2 rotate-12'></div>\n                  <div className='absolute top-1/2 left-1/2 w-7 h-0.5 bg-gradient-to-r from-transparent via-white/25 to-transparent transform -translate-x-1/2 -translate-y-1/2 -rotate-12'></div>\n                  <div className='absolute top-1/2 left-1/2 w-6 h-0.5 bg-gradient-to-r from-transparent via-white/15 to-transparent transform -translate-x-1/2 -translate-y-1/2 rotate-6'></div>\n                </div>\n              </div> */}\n              {tab.icon}\n\n              <span className='text-xs font-medium'>{tab.name}</span>\n            </button>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AACA;;;AANA;;;;;;AAQe,SAAS;;IACtB,MAAM,WAAW,IAAA,wYAAW;IAC5B,MAAM,SAAS,IAAA,sYAAS;IACxB,MAAM,EAAE,kBAAkB,EAAE,GAAG,IAAA,8LAAK;IAEpC,+BAA+B;IAC/B,IAAA,8ZAAS;+BAAC;YACR,IAAI,CAAC,SAAS,UAAU,CAAC,UAAU;gBACjC;YACF;QACF;8BAAG;QAAC;QAAU;KAAmB;IAEjC,MAAM,OAAO;QACX;YACE,MAAM;YACN,MAAM;YACN,oBAAM,ibAAC,iSAAa;gBAAC,WAAU;;;;;;QACjC;QACA;YAAE,MAAM;YAAS,MAAM;YAAS,oBAAM,ibAAC,2QAAQ;gBAAC,WAAU;;;;;;QAAa;QACvE;YAAE,MAAM;YAAS,MAAM;YAAU,oBAAM,ibAAC,8QAAQ;gBAAC,WAAU;;;;;;QAAa;KACzE;IAED,qBACE,ibAAC;QAAI,WAAU;kBACb,cAAA,ibAAC;YAAI,WAAU;sBACZ,KAAK,GAAG,CAAC,CAAA;gBACR,MAAM,WAAW,SAAS,UAAU,CAAC,IAAI,IAAI;gBAE7C,qBACE,ibAAC;oBAEC,SAAS,IAAM,OAAO,IAAI,CAAC,IAAI,IAAI;oBACnC,WAAW,AAAC,sEAEX,OADC,WAAW,eAAe;;wBAmC3B,IAAI,IAAI;sCAET,ibAAC;4BAAK,WAAU;sCAAuB,IAAI,IAAI;;;;;;;mBAxC1C,IAAI,IAAI;;;;;YA2CnB;;;;;;;;;;;AAIR;GA7EwB;;QACL,wYAAW;QACb,sYAAS;QACO,8LAAK;;;KAHd","debugId":null}},
    {"offset": {"line": 2286, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/features/thread/ThreadSidebar.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useThreads } from '@/hooks/useThreads';\nimport { useThreadContext } from '@/contexts/ThreadContext';\nimport { useUI } from '@/contexts/UIContext';\n\nexport default function ThreadSidebar() {\n  const { threads, updateThread, deleteThread } = useThreads();\n  const { selectedThreadId, setSelectedThreadId } = useThreadContext();\n  const { isThreadSidebarOpen, closeThreadSidebar } = useUI();\n  const [menuOpenId, setMenuOpenId] = useState<number | null>(null);\n  const [renamingId, setRenamingId] = useState<number | null>(null);\n  const [renameValue, setRenameValue] = useState('');\n\n  const handleSelectThread = (threadId: number) => {\n    setSelectedThreadId(threadId);\n    closeThreadSidebar();\n  };\n\n  const handleRename = async (threadId: number) => {\n    if (!renameValue.trim()) return;\n\n    try {\n      await updateThread(threadId, renameValue.trim());\n      setRenamingId(null);\n      setRenameValue('');\n      setMenuOpenId(null);\n    } catch (error) {\n      console.error('Failed to rename thread:', error);\n    }\n  };\n\n  const handleDelete = async (threadId: number) => {\n    if (!confirm('')) return;\n\n    try {\n      await deleteThread(threadId);\n      setMenuOpenId(null);\n    } catch (error) {\n      console.error('Failed to delete thread:', error);\n    }\n  };\n\n  const startRename = (thread: { id: number; title: string }) => {\n    setRenamingId(thread.id);\n    setRenameValue(thread.title);\n    setMenuOpenId(null);\n  };\n\n  return (\n    <div\n      className={`fixed top-0 left-0 h-full bg-white/5 backdrop-blur-xl border-r border-white/10 transition-all duration-300 ease-in-out z-40 ${\n        isThreadSidebarOpen ? 'w-60 translate-x-0' : 'w-0 -translate-x-full'\n      }`}\n    >\n      <div className='flex flex-col h-full overflow-hidden pb-17'>\n        {/* Header */}\n        <div className='flex items-center justify-between p-4 border-b border-white/10'>\n          <h2 className='text-lg font-semibold text-white'></h2>\n          <div className='w-5 h-5'></div>\n        </div>\n\n        {/* Thread List */}\n        <div className='flex-1 overflow-y-auto px-2 pt-5 pb-5'>\n          {threads.length === 0 ? (\n            <div className='text-center py-8 text-white/40 text-sm'>\n              \n            </div>\n          ) : (\n            <div className='space-y-1.5'>\n              {threads.map(thread => (\n                <div\n                  key={thread.id}\n                  className={`relative group rounded-lg transition-all duration-300 ${\n                    selectedThreadId === thread.id\n                      ? 'bg-white/15 border border-black shadow-[0_8px_32px_rgba(0,0,0,0.15),inset_0_1px_0_rgba(255,255,255,0.12)] hover:shadow-[0_12px_40px_rgba(0,0,0,0.25),inset_0_1px_0_rgba(255,255,255,0.18)]'\n                      : 'bg-white/3 border border-black shadow-[0_8px_32px_rgba(0,0,0,0.15),inset_0_1px_0_rgba(255,255,255,0.12)] hover:shadow-[0_12px_40px_rgba(0,0,0,0.25),inset_0_1px_0_rgba(255,255,255,0.18)]'\n                  }`}\n                >\n                  {renamingId === thread.id ? (\n                    // Rename Mode\n                    <div className='p-2'>\n                      <input\n                        type='text'\n                        value={renameValue}\n                        onChange={e => setRenameValue(e.target.value)}\n                        onKeyDown={e => {\n                          if (e.key === 'Enter') handleRename(thread.id);\n                          if (e.key === 'Escape') {\n                            setRenamingId(null);\n                            setRenameValue('');\n                          }\n                        }}\n                        className='w-full bg-black/30 text-white text-sm px-2 py-1 rounded border border-black focus:outline-none focus:border-black'\n                        autoFocus\n                      />\n                      <div className='flex gap-2 mt-2'>\n                        <button\n                          onClick={() => handleRename(thread.id)}\n                          className='flex-1 text-xs bg-white/10 hover:bg-white/20 text-white py-1 rounded transition-colors'\n                        >\n                          Save\n                        </button>\n                        <button\n                          onClick={() => {\n                            setRenamingId(null);\n                            setRenameValue('');\n                          }}\n                          className='flex-1 text-xs bg-white/5 hover:bg-white/10 text-white py-1 rounded transition-colors'\n                        >\n                          Cancel\n                        </button>\n                      </div>\n                    </div>\n                  ) : (\n                    // Normal Mode\n                    <div className='flex items-center justify-between px-2 py-2.5'>\n                      <button\n                        onClick={() => handleSelectThread(thread.id)}\n                        className={`flex-1 text-left text-sm transition-colors truncate ${\n                          selectedThreadId === thread.id\n                            ? 'text-white/80 hover:text-white'\n                            : 'text-white/50 hover:text-white/70'\n                        }`}\n                      >\n                        {thread.title}\n                      </button>\n\n                      {/* Three Dots Menu */}\n                      <div className='relative'>\n                        <button\n                          onClick={() =>\n                            setMenuOpenId(\n                              menuOpenId === thread.id ? null : thread.id\n                            )\n                          }\n                          className='p-1 text-white/40 hover:text-white/80 transition-colors'\n                        >\n                          <svg\n                            xmlns='http://www.w3.org/2000/svg'\n                            fill='none'\n                            viewBox='0 0 24 24'\n                            strokeWidth={2}\n                            stroke='currentColor'\n                            className='w-4 h-4'\n                          >\n                            <path\n                              strokeLinecap='round'\n                              strokeLinejoin='round'\n                              d='M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z'\n                            />\n                          </svg>\n                        </button>\n\n                        {/* Menu Dropdown */}\n                        {menuOpenId === thread.id && (\n                          <div className='absolute right-0 mt-1 w-32 bg-black/90 backdrop-blur-xl border border-black rounded-lg shadow-xl z-[100]'>\n                            <button\n                              onClick={() => startRename(thread)}\n                              className='w-full text-left px-3 py-2 text-sm text-white/80 hover:text-white hover:bg-white/10 transition-colors rounded-t-lg'\n                            >\n                              Rename\n                            </button>\n                            <button\n                              onClick={() => handleDelete(thread.id)}\n                              className='w-full text-left px-3 py-2 text-sm text-red-400 hover:text-red-300 hover:bg-white/10 transition-colors rounded-b-lg'\n                            >\n                              Delete\n                            </button>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2565, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/api/profileUtils.ts"],"sourcesContent":["import type { WorkspaceMember, WorkspaceProfile } from '@/types/workspace';\n\nexport type SupabaseProfile =\n  | WorkspaceProfile\n  | WorkspaceProfile[]\n  | null\n  | undefined;\n\nexport function normalizeWorkspaceProfile(\n  profile: SupabaseProfile\n): WorkspaceProfile | null | undefined {\n  if (profile === undefined) {\n    return undefined;\n  }\n\n  if (profile === null) {\n    return null;\n  }\n\n  if (Array.isArray(profile)) {\n    for (const entry of profile) {\n      const normalized = normalizeWorkspaceProfile(entry);\n      if (normalized) {\n        return normalized;\n      }\n    }\n    return null;\n  }\n\n  return {\n    id: profile.id,\n    name: profile.name ?? null,\n    avatar_url: profile.avatar_url ?? null,\n  };\n}\n\ntype MemberWithoutProfile = Omit<WorkspaceMember, 'user_profile'>;\n\nexport type SupabaseWorkspaceMember = MemberWithoutProfile & {\n  user_profile?: SupabaseProfile;\n};\n\nexport function normalizeWorkspaceMember(\n  member: SupabaseWorkspaceMember\n): WorkspaceMember {\n  return {\n    ...member,\n    role: (member.role ?? 'member') as WorkspaceMember['role'],\n    user_profile: normalizeWorkspaceProfile(member.user_profile) ?? null,\n  };\n}\n"],"names":[],"mappings":";;;;;;AAQO,SAAS,0BACd,OAAwB;IAExB,IAAI,YAAY,WAAW;QACzB,OAAO;IACT;IAEA,IAAI,YAAY,MAAM;QACpB,OAAO;IACT;IAEA,IAAI,MAAM,OAAO,CAAC,UAAU;QAC1B,KAAK,MAAM,SAAS,QAAS;YAC3B,MAAM,aAAa,0BAA0B;YAC7C,IAAI,YAAY;gBACd,OAAO;YACT;QACF;QACA,OAAO;IACT;QAIQ,eACM;IAHd,OAAO;QACL,IAAI,QAAQ,EAAE;QACd,MAAM,CAAA,gBAAA,QAAQ,IAAI,cAAZ,2BAAA,gBAAgB;QACtB,YAAY,CAAA,sBAAA,QAAQ,UAAU,cAAlB,iCAAA,sBAAsB;IACpC;AACF;AAQO,SAAS,yBACd,MAA+B;QAItB,cACO;IAHhB,OAAO;QACL,GAAG,MAAM;QACT,MAAO,CAAA,eAAA,OAAO,IAAI,cAAX,0BAAA,eAAe;QACtB,cAAc,CAAA,6BAAA,0BAA0B,OAAO,YAAY,eAA7C,wCAAA,6BAAkD;IAClE;AACF","debugId":null}},
    {"offset": {"line": 2609, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/lib/api/workspaceApi.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/browserClient';\nimport {\n  normalizeWorkspaceMember,\n  type SupabaseWorkspaceMember,\n} from '@/lib/api/profileUtils';\nimport type { Workspace, WorkspaceMember } from '@/types/workspace';\n\nconst supabase = createClient();\nconst WORKSPACE_ICON_BUCKET = 'workspace_icon';\n\nfunction extractStoragePathFromUrl(url: string): string | null {\n  try {\n    const parsed = new URL(url);\n    const parts = parsed.pathname.split('/');\n    const bucketIndex = parts.findIndex(part => part === WORKSPACE_ICON_BUCKET);\n    if (bucketIndex === -1) return null;\n    return parts.slice(bucketIndex + 1).join('/');\n  } catch (error) {\n    console.warn('Failed to parse workspace icon URL', error);\n    return null;\n  }\n}\n\nexport async function getWorkspaces(): Promise<Workspace[]> {\n  // Get current user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User not authenticated');\n  }\n\n  // Get workspace IDs where user is a member (to avoid RLS recursion)\n  const { data: memberData, error: memberError } = await supabase\n    .from('workspace_member')\n    .select('workspace_id, id, last_read_message_id')\n    .eq('user_id', user.id);\n\n  if (memberError) throw memberError;\n\n  // If user is not a member of any workspace, return empty array\n  if (!memberData || memberData.length === 0) {\n    return [];\n  }\n\n  // Get workspaces for those IDs, excluding personal workspaces\n  type WorkspaceMembershipRow = {\n    workspace_id: number;\n    id: number;\n    last_read_message_id: number | null;\n  };\n\n  const membershipRows = (memberData ?? []) as WorkspaceMembershipRow[];\n  const workspaceIds = membershipRows.map(m => m.workspace_id);\n  const { data, error } = await supabase\n    .from('workspace')\n    .select('*')\n    .in('id', workspaceIds)\n    .eq('type', 'group')\n    .order('created_at', { ascending: false });\n\n  if (error) throw error;\n\n  if (!data || data.length === 0) {\n    return [];\n  }\n\n  const membershipMap = new Map<number, WorkspaceMembershipRow>();\n  for (const membership of membershipRows) {\n    membershipMap.set(membership.workspace_id, membership);\n  }\n\n  const workspacesWithCounts = await Promise.all(\n    data.map(async workspace => {\n      const membership = membershipMap.get(workspace.id);\n\n      if (!membership) {\n        return {\n          ...workspace,\n          unread_count: 0,\n        } as Workspace;\n      }\n\n      let query = supabase\n        .from('workspace_messages')\n        .select('id', { count: 'exact', head: true })\n        .eq('workspace_id', workspace.id);\n\n      if (membership.id != null) {\n        query = query.neq('workspace_member_id', membership.id);\n      }\n\n      if (membership.last_read_message_id != null) {\n        query = query.gt('id', membership.last_read_message_id);\n      }\n\n      const { count, error: countError } = await query;\n\n      if (countError) {\n        console.warn(\n          'Failed to fetch unread message count for workspace',\n          workspace.id,\n          countError\n        );\n\n        return {\n          ...workspace,\n          unread_count: 0,\n        } as Workspace;\n      }\n\n      return {\n        ...workspace,\n        unread_count: count ?? 0,\n      } as Workspace;\n    })\n  );\n\n  return workspacesWithCounts;\n}\n\nexport async function getPersonalWorkspace(): Promise<Workspace | null> {\n  // Get current user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User not authenticated');\n  }\n\n  // Query from workspace table and join with workspace_member\n  const { data, error } = await supabase\n    .from('workspace')\n    .select(\n      `\n      *,\n      workspace_member!inner(user_id)\n    `\n    )\n    .eq('type', 'personal')\n    .eq('workspace_member.user_id', user.id)\n    .single();\n\n  if (error) throw error;\n\n  return data as Workspace | null;\n}\n\nexport async function getWorkspace(id: number): Promise<Workspace> {\n  // Get current user\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User not authenticated');\n  }\n\n  // Verify user is a member of this workspace\n  const { data: memberData, error: memberError } = await supabase\n    .from('workspace_member')\n    .select('workspace_id')\n    .eq('workspace_id', id)\n    .eq('user_id', user.id)\n    .single();\n\n  if (memberError || !memberData) {\n    throw new Error('Access denied or workspace not found');\n  }\n\n  // Fetch workspace with notes (avoiding workspace_member to prevent RLS recursion)\n  const { data, error } = await supabase\n    .from('workspace')\n    .select(\n      `\n      *,\n      notes(*)\n    `\n    )\n    .eq('id', id)\n    .single();\n\n  if (error) throw error;\n\n  return data;\n}\n\nexport async function createWorkspace(\n  title: string\n  // type: 'group' | 'personal' = 'group'\n): Promise<Workspace> {\n  // Call the database function that creates workspace and adds user as member\n  const { data, error } = await supabase.rpc('create_workspace_with_member', {\n    p_title: title,\n    // p_type: type\n  });\n\n  if (error) throw error;\n\n  // Fetch the created workspace to return it with full details\n  if (data && data.length > 0 && data[0].workspace_id) {\n    const { data: workspace, error: fetchError } = await supabase\n      .from('workspace')\n      .select('*')\n      .eq('id', data[0].workspace_id)\n      .single();\n\n    if (fetchError) throw fetchError;\n    return workspace;\n  }\n\n  throw new Error('Failed to create workspace');\n}\n\nexport async function updateWorkspace(\n  id: number,\n  updates: Partial<Pick<Workspace, 'title' | 'type' | 'icon_url'>>\n): Promise<Workspace> {\n  const { data, error } = await supabase\n    .from('workspace')\n    .update(updates)\n    .eq('id', id)\n    .select()\n    .single();\n\n  if (error) throw error;\n  return data;\n}\n\nexport async function deleteWorkspace(id: number): Promise<void> {\n  const { error } = await supabase.from('workspace').delete().eq('id', id);\n\n  if (error) throw error;\n}\n\nexport async function uploadWorkspaceIcon(\n  workspaceId: number,\n  file: File | Blob,\n  previousIconUrl?: string | null\n): Promise<{ iconUrl: string; path: string }> {\n  const fileExt = file instanceof File ? file.name.split('.').pop() : 'png';\n  const extension = fileExt\n    ? fileExt.replace(/[^a-zA-Z0-9]/g, '') || 'png'\n    : 'png';\n  const filePath = `${workspaceId}/${crypto.randomUUID()}.${extension}`;\n\n  const { error: uploadError } = await supabase.storage\n    .from(WORKSPACE_ICON_BUCKET)\n    .upload(filePath, file, {\n      cacheControl: '3600',\n      upsert: true,\n    });\n\n  if (uploadError) throw uploadError;\n\n  const {\n    data: { publicUrl },\n  } = supabase.storage.from(WORKSPACE_ICON_BUCKET).getPublicUrl(filePath);\n\n  if (previousIconUrl) {\n    const oldPath = extractStoragePathFromUrl(previousIconUrl);\n    if (oldPath) {\n      void supabase.storage.from(WORKSPACE_ICON_BUCKET).remove([oldPath]);\n    }\n  }\n\n  return { iconUrl: publicUrl, path: filePath };\n}\n\nexport async function removeWorkspaceIcon(\n  workspaceId: number,\n  currentIconUrl?: string | null\n): Promise<Workspace> {\n  if (currentIconUrl) {\n    const path = extractStoragePathFromUrl(currentIconUrl);\n    if (path) {\n      await supabase.storage.from(WORKSPACE_ICON_BUCKET).remove([path]);\n    }\n  }\n\n  return updateWorkspace(workspaceId, { icon_url: null });\n}\n\nexport async function checkWorkspaceMembership(\n  workspaceId: number\n): Promise<boolean> {\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) return false;\n\n  const { data, error } = await supabase\n    .from('workspace_member')\n    .select('workspace_id')\n    .eq('workspace_id', workspaceId)\n    .eq('user_id', user.id)\n    .maybeSingle();\n\n  return !error && data !== null;\n}\n\nexport async function getWorkspaceMembers(\n  workspaceId: number\n): Promise<WorkspaceMember[]> {\n  console.log(' getWorkspaceMembers called with workspaceId:', workspaceId);\n\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    throw new Error('User not authenticated');\n  }\n\n  // Fetch workspace members with their user profiles\n  const { data, error } = await supabase\n    .from('workspace_member')\n    .select(\n      `\n      id,\n      created_at,\n      user_id,\n      workspace_id,\n      role,\n      user_profile:user_id(id, name, avatar_url)\n    `\n    )\n    .eq('workspace_id', workspaceId)\n    .order('created_at', { ascending: true });\n\n  console.log(' getWorkspaceMembers raw response:', { data, error });\n\n  if (error) {\n    console.error(' getWorkspaceMembers error:', error);\n    console.error(' Error details:', JSON.stringify(error, null, 2));\n    throw error;\n  }\n\n  console.log(' getWorkspaceMembers data received:', data);\n  console.log(' getWorkspaceMembers data length:', data?.length);\n\n  const members = (data ?? []) as SupabaseWorkspaceMember[];\n\n  return members.map(normalizeWorkspaceMember);\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2831, "column": 0}, "map": {"version":3,"sources":["file:///Users/air13/code/cogni/cogni-frontend/apps/web/src/app/%28private%29/layout.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect } from 'react';\nimport { usePathname } from 'next/navigation';\nimport Header from '@/components/layout/Header';\nimport BottomNav from '@/components/layout/BottomNav';\nimport ThreadSidebar from '@/features/thread/ThreadSidebar';\nimport { ThreadProvider } from '@/contexts/ThreadContext';\nimport { UIProvider, useUI } from '@/contexts/UIContext';\nimport { CopilotKit } from '@copilotkit/react-core';\nimport '@copilotkit/react-textarea/styles.css';\nimport { createClient } from '@/lib/supabase/browserClient';\nimport {\n  setCurrentUserId,\n  getCurrentUserId,\n  getCookie,\n  setCookie,\n  COOKIE_KEYS,\n} from '@/lib/cookies';\nimport { getPersonalWorkspace } from '@/lib/api/workspaceApi';\n\nfunction LayoutContent({ children }: { children: React.ReactNode }) {\n  const pathname = usePathname();\n  const { isInputActive } = useUI();\n  const [isMobile, setIsMobile] = useState(false);\n  const supabase = createClient();\n\n  // Setup user session after OAuth login\n  useEffect(() => {\n    const setupUserSession = async () => {\n      try {\n        const {\n          data: { user },\n        } = await supabase.auth.getUser();\n\n        if (!user) return;\n\n        // Set user ID if not already set\n        const currentUserId = getCurrentUserId();\n        if (!currentUserId && user.id) {\n          setCurrentUserId(user.id);\n        }\n\n        // Fetch and set personal workspace if not already set\n        const personalWorkspaceId = getCookie(\n          COOKIE_KEYS.PERSONAL_WORKSPACE_ID\n        );\n        if (!personalWorkspaceId) {\n          try {\n            const personalWorkspace = await getPersonalWorkspace();\n            if (personalWorkspace?.id) {\n              setCookie(\n                COOKIE_KEYS.PERSONAL_WORKSPACE_ID,\n                personalWorkspace.id.toString()\n              );\n            }\n          } catch (error) {\n            // Log but don't fail - workspace might not exist yet\n            console.warn('Failed to fetch personal workspace:', error);\n          }\n        }\n      } catch (error) {\n        console.error('Error setting up user session:', error);\n      }\n    };\n\n    setupUserSession();\n  }, []);\n\n  const showTopLevelChrome =\n    pathname === '/home' ||\n    pathname === '/notes' ||\n    pathname === '/workspace' ||\n    pathname === '/personal' ||\n    pathname === '/user/settings';\n\n  // 768px\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth < 768);\n    };\n\n    // \n    checkMobile();\n\n    // \n    window.addEventListener('resize', checkMobile);\n    return () => window.removeEventListener('resize', checkMobile);\n  }, []);\n\n  // \n  const shouldShowFooter = showTopLevelChrome && (!isMobile || !isInputActive);\n\n  return (\n    <div className='flex flex-col h-screen bg-black text-gray-200 relative'>\n      {/* Thread Sidebar */}\n      <ThreadSidebar />\n\n      {/* Main Layout */}\n      <div className='flex flex-col h-screen'>\n        {/* Header */}\n        {showTopLevelChrome && <Header />}\n\n        {/* Main */}\n        <main className='flex-1 overflow-hidden'>{children}</main>\n\n        {/* Bottom Navigation -  */}\n        {shouldShowFooter && <BottomNav />}\n      </div>\n    </div>\n  );\n}\n\nexport default function DashboardLayout({\n  children,\n}: {\n  children: React.ReactNode;\n}) {\n  return (\n    <ThreadProvider>\n      <UIProvider>\n        <CopilotKit runtimeUrl='/api/copilotkit'>\n          <LayoutContent>{children}</LayoutContent>\n        </CopilotKit>\n      </UIProvider>\n    </ThreadProvider>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAOA;;;AAlBA;;;;;;;;;;;;;AAoBA,SAAS,cAAc,KAA2C;QAA3C,EAAE,QAAQ,EAAiC,GAA3C;;IACrB,MAAM,WAAW,IAAA,wYAAW;IAC5B,MAAM,EAAE,aAAa,EAAE,GAAG,IAAA,8LAAK;IAC/B,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6ZAAQ,EAAC;IACzC,MAAM,WAAW,IAAA,+MAAY;IAE7B,uCAAuC;IACvC,IAAA,8ZAAS;mCAAC;YACR,MAAM;4DAAmB;oBACvB,IAAI;wBACF,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;wBAE/B,IAAI,CAAC,MAAM;wBAEX,iCAAiC;wBACjC,MAAM,gBAAgB,IAAA,iMAAgB;wBACtC,IAAI,CAAC,iBAAiB,KAAK,EAAE,EAAE;4BAC7B,IAAA,iMAAgB,EAAC,KAAK,EAAE;wBAC1B;wBAEA,sDAAsD;wBACtD,MAAM,sBAAsB,IAAA,0LAAS,EACnC,4LAAW,CAAC,qBAAqB;wBAEnC,IAAI,CAAC,qBAAqB;4BACxB,IAAI;gCACF,MAAM,oBAAoB,MAAM,IAAA,iNAAoB;gCACpD,IAAI,8BAAA,wCAAA,kBAAmB,EAAE,EAAE;oCACzB,IAAA,0LAAS,EACP,4LAAW,CAAC,qBAAqB,EACjC,kBAAkB,EAAE,CAAC,QAAQ;gCAEjC;4BACF,EAAE,OAAO,OAAO;gCACd,qDAAqD;gCACrD,QAAQ,IAAI,CAAC,uCAAuC;4BACtD;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,kCAAkC;oBAClD;gBACF;;YAEA;QACF;kCAAG,EAAE;IAEL,MAAM,qBACJ,aAAa,WACb,aAAa,YACb,aAAa,gBACb,aAAa,eACb,aAAa;IAEf,kBAAkB;IAClB,IAAA,8ZAAS;mCAAC;YACR,MAAM;uDAAc;oBAClB,YAAY,OAAO,UAAU,GAAG;gBAClC;;YAEA,SAAS;YACT;YAEA,aAAa;YACb,OAAO,gBAAgB,CAAC,UAAU;YAClC;2CAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACpD;kCAAG,EAAE;IAEL,sCAAsC;IACtC,MAAM,mBAAmB,sBAAsB,CAAC,CAAC,YAAY,CAAC,aAAa;IAE3E,qBACE,ibAAC;QAAI,WAAU;;0BAEb,ibAAC,8MAAa;;;;;0BAGd,ibAAC;gBAAI,WAAU;;oBAEZ,oCAAsB,ibAAC,yMAAM;;;;;kCAG9B,ibAAC;wBAAK,WAAU;kCAA0B;;;;;;oBAGzC,kCAAoB,ibAAC,4MAAS;;;;;;;;;;;;;;;;;AAIvC;GA1FS;;QACU,wYAAW;QACF,8LAAK;;;KAFxB;AA4FM,SAAS,gBAAgB,KAIvC;QAJuC,EACtC,QAAQ,EAGT,GAJuC;IAKtC,qBACE,ibAAC,2MAAc;kBACb,cAAA,ibAAC,mMAAU;sBACT,cAAA,ibAAC,sbAAU;gBAAC,YAAW;0BACrB,cAAA,ibAAC;8BAAe;;;;;;;;;;;;;;;;;;;;;AAK1B;MAdwB","debugId":null}}]
}